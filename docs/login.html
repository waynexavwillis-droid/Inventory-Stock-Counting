<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sign in</title>
  <style>
    body { margin:0; min-height:100vh; display:grid; place-items:center; font-family:system-ui, Arial; background:#f9f9f9; }
    .card { width:min(420px,92vw); border:1px solid #e5e7eb; border-radius:12px; padding:24px; box-shadow:0 6px 20px rgba(0,0,0,.06); background:#fff; }
    h1 { margin:0 0 4px; text-align:center; }
    .muted { color:#667085; font-size:14px; margin:0 0 16px; text-align:center; }
    label { font-size:14px; display:block; margin:.5rem 0 .25rem; }
    input { width:100%; padding:10px 12px; border:1px solid #cbd5e1; border-radius:8px; font-size:16px; }
    button { margin-top:14px; width:100%; padding:10px 12px; border:0; border-radius:8px; background:#0B2447; color:#fff; font-size:16px; cursor:pointer; }
    .err { color:#b91c1c; font-size:14px; min-height:18px; margin-top:8px; text-align:center; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Inventory Login</h1>
    <p class="muted">Please enter your username and password.</p>

    <form id="login-form">
      <label for="username">Username</label>
      <input id="username" type="text" required placeholder="Enter username" autocomplete="username" />

      <label for="pw">Password</label>
      <input id="pw" type="password" required placeholder="Enter password" autocomplete="current-password" />

      <button type="submit">Sign in</button>
      <div id="err" class="err"></div>
    </form>
  </div>

  <script>
    // username -> { hash: <SHA-256 hex of password>, role: 'editor' | 'viewer' }
    const ACCOUNTS = {
      // EPEDU : EPEDU2025SECURELOGIN
      "EPEDU":     { hash: "dcb29d675b72d042c839362546f63501afd9130965b0193b1718c2e6bd99ca80", role: "editor" },
      // gwenntan : EPasia!234
      "gwenntan":  { hash: "9440524470c0fd7f13b67eeb3a56354a46158c04f82b660f50fa96da3b481b48", role: "editor" },
      // EPSUPPORT : EPSUPPORTISTHEBEST2025  -> viewer
      "EPSUPPORT": { hash: "844bfaecdd264b1422e6ccb9bd789757fe34c358d76edf2d0790e0b0997882e3", role: "viewer" },
      // NEW — Sally Kan : Epasia0507  -> editor (change to "viewer" if you prefer)
      "Sally Kan": { hash: "d3dc9ee2aecc08b4b60b1258449a96c5b0ee80bb61964915f2918a4b36dbe39b", role: "editor" }
    };

    async function sha256Hex(text) {
      const enc = new TextEncoder().encode(text);
      const hash = await crypto.subtle.digest('SHA-256', enc);
      return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2,'0')).join('');
    }

    const form = document.getElementById('login-form');
    const err  = document.getElementById('err');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      err.textContent = '';

      const username = document.getElementById('username').value.trim();
      const pw       = document.getElementById('pw').value;

      const acct = ACCOUNTS[username];
      if (!acct) { err.textContent = 'Invalid username.'; return; }

      const givenHash = await sha256Hex(pw);
      if (givenHash !== acct.hash) { err.textContent = 'Invalid password.'; return; }

      // success — store auth + role and route appropriately
      localStorage.setItem('auth_v1','ok');
      localStorage.setItem('auth_user', username);
      localStorage.setItem('auth_role', acct.role);
      localStorage.setItem('auth_time', String(Date.now()));

      location.href = (acct.role === 'viewer') ? 'viewer.html' : 'index.html';
    });

    // Already authenticated? send to the correct page.
    const ok   = localStorage.getItem('auth_v1') === 'ok';
    const role = localStorage.getItem('auth_role');
    if (ok && role) {
      location.replace(role === 'viewer' ? 'viewer.html' : 'index.html');
    }
  </script>
</body>
</html>
